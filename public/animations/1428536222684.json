{"name":"Bressenham","filename":"1428536222684.js","author":"Ben","code":"\r\nvar tweenedValues = {\r\n    hue: 0\r\n};\r\n\r\nvar a = {x:0,y:0}, b = {x:0,y:0},\r\n    aTarget = null, bTarget = null,\r\n    aTween = null, bTween = null;\r\n\r\n\r\n\r\nfunction randomPoint(point) {\r\n    if (!point) {\r\n        point = {x:0, y:0};\r\n    }\r\n    point.x = Math.random()*51;\r\n    point.y = Math.random()*33;\r\n    return point;\r\n}\r\nreturn {\r\n\r\n    updateTween: function(aOrB, reversed) {\r\n        // select random a and b targets\r\n        var target = aOrB == 'a' ? aTarget : bTarget;\r\n        var tween = aOrB == 'a' ? aTween : bTween;\r\n        var src = aOrB == 'a' ? a : b;\r\n        \r\n        tween.from({\r\n            x: target.x,\r\n            y: target.y\r\n        });\r\n        randomPoint(target);\r\n        var duration = 2000+300;\r\n        /*tween.from({\r\n            x: src.x,\r\n            y: src.y\r\n        });*/\r\n        tween.to({\r\n            x: target.x,\r\n            y: target.y\r\n        }, duration);\r\n        \r\n        tween.start();\r\n    },\r\n    startTween: function() {\r\n        \r\n        // select random a and b targets\r\n        aTarget = randomPoint(aTarget);\r\n        bTarget = randomPoint(bTarget);\r\n        \r\n        var duration = 2000+300;\r\n        aTween = new TWEEN.Tween(a)\r\n            .to({\r\n                x: aTarget.x,\r\n                y: aTarget.y\r\n            }, duration);\r\n        aTween.repeat(Infinity);\r\n        aTween.easing(TWEEN.Easing.Cubic.InOut);\r\n        bTween = new TWEEN.Tween(b)\r\n            .to({\r\n                x: bTarget.x,\r\n                y: bTarget.y\r\n            }, duration);\r\n        bTween.repeat(Infinity);\r\n        bTween.easing(TWEEN.Easing.Cubic.InOut);\r\n        \r\n        aTween.onRepeat(this.updateTween.bind(this,'a'));\r\n        bTween.onRepeat(this.updateTween.bind(this,'b'));\r\n        \r\n        this.display.tweens.push(aTween);\r\n        this.display.tweens.push(bTween);\r\n    },\r\n    init: function(display,timeline) {\r\n        this.display = display;\r\n    //debugger;\r\n        display.tween(tweenedValues,{\r\n          to: {hue: 1},\r\n          duration: 5000,\r\n          repeat: Infinity,\r\n          yoyo: true,\r\n          delay: 0,\r\n          easing: TWEEN.Easing.Cubic.InOut\r\n        });\r\n        \r\n        // calculate random a and b points\r\n        randomPoint(a);\r\n        randomPoint(b);\r\n        \r\n        display.clear();\r\n        \r\n        this.startTween();\r\n    },\r\n    onUpdate: function(display, data) {\r\n        var c = null;\r\n\r\n        //display.clear();\r\n        \r\n        for (var i=0; i < display.leds.length; ++i) {\r\n            display.leds[i].multiplyScalar(0.94);\r\n        }\r\n        \r\n        var h = ((tweenedValues.hue))%1,\r\n            s = 1,\r\n            l = 0.5;\r\n        var c = new Color();\r\n        c.setHSL(h,s,l);\r\n        // draw the line\r\n        display.drawLine(a.x,a.y,b.x,b.y, c);\r\n        \r\n    }\r\n};","publish":true,"script":{}}